<f:layout name="BackendModule" />

<f:section name="Headline">
	<f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.log" />
</f:section>

<f:section name="Content">
	<br />
	<div>
		{refreshLink -> f:format.raw()}
		{enableDisableToggle -> f:format.raw()}
		{addLink -> f:format.raw()}
		{modeLink -> f:format.raw()}
	</div>
	<h3>
		<f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.generalinformation" />
	</h3>
	<table class="table table-striped table-bordered">
		<tr>
			<td><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.pendingoverview" /></td>
			<td>{assignedUnprocessedItemCount} / {totalUnprocessedItemCount}</td>
		</tr>
		<tr>
			<td><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.curtime" /></td>
			<td><f:format.date format="H:i:s">now</f:format.date></td>
		</tr>
		<tr>
			<td><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.processcount" /></td>
			<td>{activeProcessCount} / {maxActiveProcessCount}</td>
		</tr>
		<tr>
			<td><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.clipath" /></td>
			<td>{cliPath}</td>
		</tr>
	</table>
	<h3>
		<f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.processstates" />
	</h3>
	<table class="table table-striped table-bordered">
		<thead>
			<tr>
				<th><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.state" /></th>
				<th><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.processid" /></th>
				<th><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.time.first" /></th>
				<th><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.time.last" /></th>
				<th><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.time.duration" /></th>
				<th><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.ttl" /></th>
				<th><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.status.current" /></th>
				<th><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.status.initial" /></th>
				<th><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.status.finally" /></th>
				<th><f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.status.progress" /></th>
			</tr>
		</thead>
		<tbody>
		<f:for each="{processCollection}" as="process">
			<tr>
				<td>
					<f:switch expression="{process.state}">
						<f:case value="running">
							<img src="{f:uri.resource(path: 'Icons/bullet_orange.png', extensionName: 'crawler')}" alt="" title="{f:translate(key: 'LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.process.running')}" />
						</f:case>
						<f:case value="cancelled">
							<img src="{f:uri.resource(path: 'Icons/bullet_red.png', extensionName: 'crawler')}" alt="" title="{f:translate(key: 'LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.process.cancelled')}" />
						</f:case>
						<f:case value="completed">
							<img src="{f:uri.resource(path: 'Icons/bullet_green.png', extensionName: 'crawler')}" alt="" title="{f:translate(key: 'LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.process.success')}" />
						</f:case>
					</f:switch>
				</td>
				<td>{process.processId}</td>
				<td><f:format.date>{process.timeForFirstItem}</f:format.date></td>
				<td><f:format.date>{process.timeForLastItem}</f:format.date></td>
				<td>TODO: <?php echo htmlspecialchars(floor($process->getRuntime() / 60)); ?> min. <?php echo htmlspecialchars($process->getRuntime()) % 60 ?> sec.</td>
				<td><f:format.date>{process.ttl}</f:format.date></td>
				<td>{process.countItemsProcessed}</td>
				<td>{process.assignedItemsCount}</td>
				<td>{process.countItemsToProcess} + {process.countItemsProcessed}</td>
				<td>
					<f:switch expression="{process.state}">
						<f:case value="running">
							<div class="crawlerprocessprogress" style="width: 200px;">
								<div class="crawlerprocessprogress-bar" style="width: {process.progress}%" ></div>
								<div class="crawlerprocessprogress-label">{process.progress} %</div>
							</div>
						</f:case>
						<f:case value="cancelled">
							<f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.process.cancelled" />
						</f:case>
						<f:defaultCase>
							<f:translate key="LLL:EXT:crawler/Resources/Private/Language/locallang.xml:labels.process.success" />
						</f:defaultCase>
					</f:switch>
				</td>
			</tr>
		</f:for>
		</tbody>
	</table>
</f:section>
